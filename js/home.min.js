!function(e){var a={};function t(n){if(a[n])return a[n].exports;var l=a[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var l in e)t.d(n,l,function(a){return e[a]}.bind(null,l));return n},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="/",t(t.s=72)}({72:function(e,a,t){e.exports=t(73)},73:function(e,a){window.onload=function(){window.ablyapp=new Ably.Realtime({authUrl:"authhallwait"}),ablyapp.connection.on("connected",function(){axios.get("get-channel").then(function(e){window.channel=window.ablyapp.channels.get(e.data.nameChannel),window.channelHall=window.ablyapp.channels.get("hall_wait"),channel.unsubscribe(),channelHall.unsubscribe(),channel.subscribe("private_user",function(e){300==e.data.status&&(ablyapp.close(),delete window.ablyapp,$("#block-ui").show())}),channelHall.presence.enter({user:$("#name-user").data("name"),score:$("#score-user").data("score"),message:"nuevo"});var a='<tr id=":idplayer:">\n                            <td>:name:</td>\n                            <td>:score:</td>\n                            <td><a class="btn btn-primary btn-retar btn-sm text-white" data-idplayer=":idplayer:"><span>Retar</span><i class="fa fa-play ml-1"></i></a></td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>',t=$("#section-users"),n=$("#table-users").find("tr.head-table");channelHall.presence.get(function(e,l){$("#load-players").hide();var o="";for(var c in l){if(l[c].clientId!=ablyapp.auth.clientId)o+=a.replace(/:idplayer:/g,l[c].clientId).replace(":name:",l[c].data.user).replace(":score:",l[c].data.score)}t.append(o),t.find("tr").length>0&&n.show()}),channelHall.presence.subscribe("enter",function(e){if(ablyapp.auth.clientId!=e.clientId){var l=a.replace(/:idplayer:/g,e.clientId).replace(":name:",e.data.user).replace(":score:",e.data.score);t.append(l),t.find("tr").length>0&&n.show()}}),channelHall.presence.subscribe("leave",function(e){document.getElementById(e.clientId).remove(),t.find("tr").length<1&&n.hide()}),channelHall.subscribe("challenger",function(e){console.log(e,ablyapp.auth.clientId),1==e.data.status&&e.data.retador!=ablyapp.auth.clientId&&e.data.me==ablyapp.auth.clientId&&(askAcceptChallenge({name:e.data.name,retador:e.data.retador}),console.log("entra a status 1")),2==e.data.status&&e.data.retador==ablyapp.auth.clientId&&(console.log("entra a status 2"),cleanWaitGame(),bootbox.hideAll()),3==e.data.status&&e.data.retador!=ablyapp.auth.clientId&&e.data.me==ablyapp.auth.clientId&&(console.log("entra a status 3"),bootbox.hideAll()),4==e.data.status&&e.data.retador==ablyapp.auth.clientId&&(console.log("entra a status 4"),cleanWaitGame(),bootbox.hideAll(),checkPresencia())})})}),$(document).on("click",".btn-retar",function(e){channelHall.publish("challenger",{retador:ablyapp.auth.clientId,name:$("#name-user").data("name"),me:$(this).data("idplayer"),status:1}),waitAcceptChallenge({me:$(this).data("idplayer")})}),window.askAcceptChallenge=function(e){var a=!1;window.waitDialog=bootbox.confirm({message:'<h3 class="swal-title">El jugador '+e.name+' quiere jugar contigo, <span id="close-wait">30</span></h3>',modal:!1,closeButton:!1,buttons:{confirm:{label:"Aceptar",className:"btn-app btn text-white",value:1},cancel:{label:"Rechazar",className:"btn-dark"}},callback:function(e){e&&(a=!0)}}).on("shown.bs.modal",function(){cronoWaitGame()}).on("hidden.bs.modal",function(){cleanWaitGame(),a?($("#block-ui-load").show(),axios.post("creategamechallenge",{user:e.retador}).then(function(){acceptChallenge({retador:e.retador}),location.href="playgame"})):rejectChallenge({retador:e.retador})})},window.rejectChallenge=function(e){channelHall.publish("challenger",{retador:e.retador,status:2})},window.acceptChallenge=function(e){channelHall.publish("challenger",{retador:e.retador,status:4})},window.waitAcceptChallenge=function(e){window.waitDialog=bootbox.dialog({message:'<h3 class="swal-title">Esperar a que el jugador acepte, <span id="close-wait">30</span></h3>',modal:!0,closeButton:!1,onEscape:!1,buttons:{ok:{label:"Cancelar",className:"btn-dark",callback:function(){}}}}).on("shown.bs.modal",function(){cronoWaitGame()}).on("hidden.bs.modal",function(){cancelChallenge({me:e.me})})},window.checkPresencia=function(){$("#block-ui-load").show(),axios.post("checkgame").then(function(){location.href="playgame"})},window.cancelChallenge=function(e){cleanWaitGame(),channelHall.publish("challenger",{retador:ablyapp.auth.clientId,me:e.me,status:3})},window.cronoWaitGame=function(){window.timeWait=30,window.cronoWait=setInterval(function(){timeWait--,$("#close-wait").html(timeWait),0==timeWait&&waitDialog.modal("hide")},1e3)},window.cleanWaitGame=function(){clearInterval(cronoWait)}}}});