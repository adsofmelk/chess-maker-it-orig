!function(a){var e={};function t(n){if(e[n])return e[n].exports;var l=e[n]={i:n,l:!1,exports:{}};return a[n].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=a,t.c=e,t.d=function(a,e,n){t.o(a,e)||Object.defineProperty(a,e,{configurable:!1,enumerable:!0,get:n})},t.n=function(a){var e=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(e,"a",e),e},t.o=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)},t.p="/",t(t.s=78)}({78:function(a,e,t){a.exports=t(79)},79:function(a,e){window.onload=function(){window.ablyapp=new Ably.Realtime({authUrl:"authhallwait"}),ablyapp.connection.on("connected",function(){axios.get("get-channel").then(function(a){window.channel=window.ablyapp.channels.get(a.data.nameChannel),window.channelHall=window.ablyapp.channels.get("hall_wait"),channel.unsubscribe(),channelHall.unsubscribe(),channel.subscribe("private_user",function(a){300==a.data.status&&(ablyapp.close(),delete window.ablyapp,$("#block-ui").show())}),channelHall.presence.enter({user:$("#name-user").data("name"),score:$("#score-user").data("score"),message:"nuevo"});var e='<tr id=":idplayer:">\n                            <td>:name:</td>\n                            <td>:score:</td>\n                            <td><a class="btn btn-primary btn-retar btn-sm text-white" data-idplayer=":idplayer:"><span>Retar</span><i class="fa fa-play ml-1"></i></a></td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>',t=$("#section-users"),n=$("#table-users").find("tr.head-table");channelHall.presence.get(function(a,l){$("#load-players").hide();var o="";for(var c in l){if(l[c].clientId!=ablyapp.auth.clientId)o+=e.replace(/:idplayer:/g,l[c].clientId).replace(":name:",l[c].data.user).replace(":score:",l[c].data.score)}t.append(o),t.find("tr").length>0&&n.show()}),channelHall.presence.subscribe("enter",function(a){if(ablyapp.auth.clientId!=a.clientId){var l=e.replace(/:idplayer:/g,a.clientId).replace(":name:",a.data.user).replace(":score:",a.data.score);t.append(l),t.find("tr").length>0&&n.show()}}),channelHall.presence.subscribe("leave",function(a){document.getElementById(a.clientId).remove(),t.find("tr").length<1&&n.hide()}),channelHall.subscribe("challenger",function(a){1==a.data.status&&a.data.retador!=ablyapp.auth.clientId&&a.data.me==ablyapp.auth.clientId&&askAcceptChallenge({name:a.data.name,retador:a.data.retador}),2==a.data.status&&a.data.retador==ablyapp.auth.clientId&&(cleanWaitGame(),bootbox.hideAll()),3==a.data.status&&a.data.retador!=ablyapp.auth.clientId&&a.data.me==ablyapp.auth.clientId&&bootbox.hideAll(),4==a.data.status&&a.data.retador==ablyapp.auth.clientId&&(cleanWaitGame(),bootbox.hideAll(),checkPresencia())})})}),$(document).on("click",".btn-retar",function(a){channelHall.publish("challenger",{retador:ablyapp.auth.clientId,name:$("#name-user").data("name"),me:$(this).data("idplayer"),status:1}),waitAcceptChallenge({me:$(this).data("idplayer")})}),window.askAcceptChallenge=function(a){var e=!1;window.waitDialog=bootbox.confirm({message:'<h3 class="swal-title">El jugador '+a.name+' quiere jugar contigo, <span id="close-wait">30</span></h3>',modal:!1,closeButton:!1,buttons:{confirm:{label:"Aceptar",className:"btn-app btn text-white",value:1},cancel:{label:"Rechazar",className:"btn-dark"}},callback:function(a){a&&(e=!0)}}).on("shown.bs.modal",function(){cronoWaitGame()}).on("hidden.bs.modal",function(){cleanWaitGame(),e?($("#block-ui-load").show(),axios.post("creategamechallenge",{user:a.retador}).then(function(){location.href="playgame",acceptChallenge({retador:a.retador})})):rejectChallenge({retador:a.retador})})},window.rejectChallenge=function(a){channelHall.publish("challenger",{retador:a.retador,status:2})},window.acceptChallenge=function(a){channelHall.publish("challenger",{retador:a.retador,status:4})},window.waitAcceptChallenge=function(a){window.waitDialog=bootbox.dialog({message:'<h3 class="swal-title">Esperar a que el jugador acepte, <span id="close-wait">30</span></h3>',modal:!0,closeButton:!1,onEscape:!1,buttons:{ok:{label:"Cancelar",className:"btn-dark",callback:function(){}}}}).on("shown.bs.modal",function(){cronoWaitGame()}).on("hidden.bs.modal",function(){cancelChallenge({me:a.me})})},window.checkPresencia=function(){$("#block-ui-load").show(),axios.post("checkgame").then(function(){location.href="playgame"})},window.cancelChallenge=function(a){cleanWaitGame(),channelHall.publish("challenger",{retador:ablyapp.auth.clientId,me:a.me,status:3})},window.cronoWaitGame=function(){window.timeWait=30,window.cronoWait=setInterval(function(){timeWait--,$("#close-wait").html(timeWait),0==timeWait&&waitDialog.modal("hide")},1e3)},window.cleanWaitGame=function(){clearInterval(cronoWait)}}}});